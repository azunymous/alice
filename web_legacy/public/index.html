<!DOCTYPE html>
<html lang="en">

<head>
    <title>alice</title>
    <link href="stylesheet.css" rel="stylesheet">
    <script src="js/api.js"></script>
    <script src="js/jquery-3.4.1.min.js"></script>
</head>

<body>
<img src="login-rounded-right.png" class="login-toggle" onclick="openLogin()">

<form class="box" id='loginForm' action="javascript:loginForm();" method="post" hidden>
    <h1 id="greeting" class="scale"></h1>
    <fieldset id='loginFieldSet'><p id="error"></p>
        <span class="centre"><p class="clickable anon-button" onclick="anonRegister()">Anonymous Login</p></span>
        <hr>
        <div class="inputBox">
            <input id="name" type="text" placeholder="Username" name="username">
        </div>

        <div class="inputBox">
            <input id="password" type="password" placeholder="Password" name="password">
        </div>

        <span class="centre"><button type="submit" class="loginbtn btn-grad">Name Login</button></span>

        <span class="centre"><p class="clickable" onclick="openRegistration()">Create an account</p></span>

    </fieldset>
</form>

<form class="box" id='registerForm' action="javascript:registerForm();" method="post" hidden>
    <p>Create an account</p>
    <fieldset><p id="error"></p>
        <div class="inputBox">
            <input id="name" type="text" placeholder="Username" name="username">
        </div>
        <div class="inputBox">
            <input type="text" placeholder="Email" name="email" required>
        </div>
        <div class="inputBox">
            <input id="password" type="password" placeholder="Password" name="password">
        </div>
        <span class="centre"> <button type="submit" class="registerbtn btn-grad">Register</button></span>


    </fieldset>
</form>

<div class="app" id="gallery">
    <div class="item"><img src="images/14.jpg"></div>
    <div class="item"><img src="images/12.jpg"></div>
    <div class="item"><img src="images/11.jpg"></div>
    <div class="item"><img src="images/10.jpg"></div>
</div>

<script>
    // Total images - image folder should have images names frm 0.jpg to <totalImages>-1.jpg
    var totalImages = 359
    // Maximum number of images on page. Cuts off at this point when displaying grid of shuffled images
    var imageNumber = 100;
    var array = [];
    for (var i = 0; i < totalImages; i++) {
        array.push(i)
    }

    function shuffleArray(array) {
        for (var i = array.length - 1; i > 0; i--) {
            var j = Math.floor(Math.random() * (i + 1));
            var temp = array[i];
            array[i] = array[j];
            array[j] = temp;
        }
    }

    shuffleArray(array)


    var gallery = document.getElementById("gallery");
    var allImageHTML = '';
    for (var i = 0; i < imageNumber; i++) {
        allImageHTML += '<div class="item"><img class="lazy" src="images/' + array[i] + '_300.jpg" data-src="images/' + array[i] + '.jpg"></div>';
    }
    gallery.innerHTML = allImageHTML

    function openLogin() {
        var registerForm = document.getElementById("registerForm");
        registerForm.setAttribute("hidden", "")

        var loginForm = document.getElementById("loginForm");
        if (loginForm.hasAttribute("hidden")) {
            loginForm.removeAttribute("hidden")
        } else {
            loginForm.setAttribute("hidden", "")
        }

    }

    function openRegistration() {
        var loginForm = document.getElementById("loginForm");
        loginForm.setAttribute("hidden", "")

        var registerForm = document.getElementById("registerForm");
        if (registerForm.hasAttribute("hidden")) {
            registerForm.removeAttribute("hidden")
        } else {
            registerForm.setAttribute("hidden", "")
        }

    }

    document.addEventListener("DOMContentLoaded", function () {
        var lazyImages = [].slice.call(document.querySelectorAll("img.lazy"));

        if ("IntersectionObserver" in window) {
            let lazyImageObserver = new IntersectionObserver(function (entries, observer) {
                entries.forEach(function (entry) {
                    if (entry.isIntersecting) {
                        let lazyImage = entry.target;
                        lazyImage.src = lazyImage.dataset.src;
                        // lazyImage.srcset = lazyImage.dataset.srcset;
                        lazyImage.classList.remove("lazy");
                        lazyImageObserver.unobserve(lazyImage);
                    }
                });
            });

            lazyImages.forEach(function (lazyImage) {
                lazyImageObserver.observe(lazyImage);
            });
        } else {
            console.log("Easy lazy loading not supported")
        }
    });

</script>
</body>

</html>